---
description: React/TypeScript frontend rules for the Cesium-based mission planning UI
---

# Frontend Rules

**Glob: frontend/src/**/*.ts, frontend/src/**/*.tsx**

## Stack

- React 18 + TypeScript (strict mode) + Vite 7
- Cesium/Resium for 3D globe visualization
- Zustand for client state, React Query (@tanstack/react-query) for server state
- TailwindCSS for styling, Lucide for icons
- react-hook-form + Zod for form validation
- Vitest + Testing Library for tests

## Component Conventions

- Functional components only. Use explicit `JSX.Element` return type.
- Prefer named exports. Default export only for page-level components.
- Import alias: `@/` maps to `frontend/src/` (configured in tsconfig + vite).
- Keep components under 300 lines. Extract hooks for complex logic.
- Use `ErrorBoundary` wrapper for any Cesium-related or complex component sections.
- Lazy-load heavy components via `frontend/src/components/lazy.ts`.

## State Management

- **Zustand stores** (`frontend/src/store/`): client-only UI state (selection, visibility, slew, conflicts).
  - Each store is a single file. Barrel-exported from `store/index.ts`.
  - Store naming: `use{Domain}Store` (e.g., `useVisStore`, `useSelectionStore`).
  - Never put API calls in stores. Stores are pure state + actions.
- **React Query** (`frontend/src/hooks/queries/`): all server data fetching.
  - Query hooks: `use{Resource}Queries.ts` (e.g., `useTLEQueries`, `useMissionQueries`).
  - Use query keys consistently. Invalidate on mutations.
- **MissionContext** (`frontend/src/context/MissionContext.tsx`): mission-wide shared state.
  - This file is very large (983 lines). Prefer adding new state to Zustand stores instead.

## API Layer

- API client: `frontend/src/api/client.ts` (Axios-based).
- API modules: `frontend/src/api/{resource}.ts` (e.g., `scheduleApi.ts`, `workspaces.ts`).
- All API calls go through the proxy: `/api/*` â†’ `localhost:8000`.
- Error handling: use `frontend/src/api/errors.ts` and `frontend/src/utils/errorMapper.ts`.
- Schemas: `frontend/src/api/schemas/` for Zod validation of API responses.

## Types

- Shared types: `frontend/src/types/index.ts` (CZML, TLE, Target, Mission types).
- Explorer types: `frontend/src/types/explorer.ts`.
- Keep types co-located with their domain when possible; only promote to `types/` when shared.

## Styling

- Use Tailwind utility classes. Custom theme colors defined in `tailwind.config.js`:
  - `space-blue` (#0B1426), `orbit-yellow` (#FFD700), `target-red` (#FF4444), `pass-green` (#00FF88)
- Dark theme by default (bg-gray-900, text-white, border-gray-700 patterns).
- Font: JetBrains Mono for data displays (`font-mono` class).
- Reusable UI primitives: `frontend/src/components/ui/` (Button, Card, Modal, Tabs, etc.).

## Cesium / 3D Globe

- Cesium base URL: `/cesium/` (defined in `vite.config.ts`).
- CZML is the primary data format for Cesium entities (generated by backend).
- Globe components: `frontend/src/components/Map/` (MultiViewContainer, GlobeViewport, etc.).
- Cesium viewer instance: managed in `CesiumViewer.tsx`.
- Static Cesium assets copied via `vite-plugin-static-copy` in vite config.

## Testing

- Framework: Vitest + @testing-library/react + jsdom.
- Config: `frontend/vitest.config.ts`.
- UI component tests: `frontend/src/components/ui/__tests__/`.
- Run: `make test-fe` or `cd frontend && npm run test:run`.

## Constants

- UI constants: `frontend/src/constants/ui.ts`
- Cesium constants: `frontend/src/constants/cesium.ts`
- Color palettes: `frontend/src/constants/colors.ts`
- Simple mode config: `frontend/src/constants/simpleMode.ts`
